<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trắc nghiệm Toán 9 - Phương trình bậc hai</title>

<script src="https://cdn.tailwindcss.com"></script>

<script>
window.MathJax = {
    tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
    }
};
</script>
<script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<style>
body{
    font-family: sans-serif;
    background: linear-gradient(135deg,#f0f9ff,#e0f2fe);
}
.option-btn{
    border:2px solid #e2e8f0;
    transition:0.2s;
}
.option-btn:hover{
    border-color:#3b82f6;
    background:#eff6ff;
}
.correct{border-color:#22c55e!important;background:#f0fdf4!important;}
.wrong{border-color:#ef4444!important;background:#fef2f2!important;}
</style>
</head>

<body class="p-6 flex justify-center">

<div id="app" class="w-full max-w-2xl bg-white p-8 rounded-2xl shadow-xl"></div>

<script>

const state = {
screen:'start',
current:0,
score:0,
time:20,
timer:null,
answered:false,
questions:[
{
q:"Phương trình nào là phương trình bậc hai một ẩn?",
options:["$x+2=0$","$x^2-5x+6=0$","$x^3-1=0$","$0x^2+3x-1=0$"],
correct:1,
explain:"Dạng $ax^2+bx+c=0$ với $a\\ne0$."
},
{
q:"Nghiệm của $x^2-9=0$ là:",
options:["$3$","$-3$","$\\pm3$","$9$"],
correct:2,
explain:"$x^2=9 \\Rightarrow x=\\pm3$."
}
]
};

const app=document.getElementById("app");

function render(){
if(state.screen==="start"){
app.innerHTML=`
<h1 class="text-3xl font-bold text-blue-600 mb-6 text-center">
Đấu Trường Toán 9
</h1>
<button onclick="startQuiz()" class="w-full bg-blue-500 text-white py-3 rounded-xl font-bold">
Bắt đầu
</button>
`;
}

if(state.screen==="quiz"){
const q=state.questions[state.current];
app.innerHTML=`
<div class="flex justify-between mb-4">
<span>Câu ${state.current+1}/${state.questions.length}</span>
<span>${state.time}s</span>
</div>

<h2 class="mb-6 font-semibold">${q.q}</h2>

<div class="space-y-3">
${q.options.map((o,i)=>`
<button onclick="check(${i})" 
class="option-btn w-full p-3 rounded-xl text-left"
id="opt${i}">
${o}
</button>
`).join("")}
</div>

<div id="feedback" class="mt-6 hidden">
<p id="fbText" class="font-bold mb-3"></p>
<p class="text-blue-600">${q.explain}</p>
<button onclick="next()" class="mt-4 bg-blue-500 text-white px-6 py-2 rounded-xl">
Tiếp tục
</button>
</div>
`;
MathJax.typeset();
startTimer();
}

if(state.screen==="result"){
app.innerHTML=`
<h2 class="text-3xl font-bold text-center mb-6">
Điểm của bạn: ${state.score}/${state.questions.length}
</h2>
<button onclick="restart()" class="w-full bg-blue-500 text-white py-3 rounded-xl">
Làm lại
</button>
`;
}
}

function startQuiz(){
state.screen="quiz";
state.current=0;
state.score=0;
render();
}

function startTimer(){
state.time=20;
clearInterval(state.timer);
state.timer=setInterval(()=>{
state.time--;
renderTime();
if(state.time<=0){
clearInterval(state.timer);
check(-1);
}
},1000);
}

function renderTime(){
const spans=app.querySelectorAll("span");
if(spans[1]) spans[1].innerText=state.time+"s";
}

function check(i){
if(state.answered) return;
state.answered=true;
clearInterval(state.timer);

const q=state.questions[state.current];
const feedback=document.getElementById("feedback");
const fbText=document.getElementById("fbText");

feedback.classList.remove("hidden");

if(i===q.correct){
state.score++;
document.getElementById("opt"+i).classList.add("correct");
fbText.innerText="Chính xác!";
fbText.className="text-green-600 font-bold mb-3";
}else{
if(i!=-1) document.getElementById("opt"+i).classList.add("wrong");
fbText.innerText="Chưa đúng!";
fbText.className="text-red-600 font-bold mb-3";
}
}

function next(){
state.answered=false;
if(state.current<state.questions.length-1){
state.current++;
render();
}else{
state.screen="result";
render();
}
}

function restart(){
state.screen="start";
render();
}

render();

</script>
</body>
</html>
